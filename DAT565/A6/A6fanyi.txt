### **DAT565/DIT407 数据科学与人工智能导论**
**作业 6**  
**截止日期：2024 年 12 月 14 日 12:00**
### 作业概述：
本次作业将使用神经网络分析 MNIST 手写数字数据集 [1]。该数据集由灰度手写数字图像（数字 0 至 9）组成，图像已被归一化为 28×28 的位图格式，每个图像均配有正确的标签。我们将构建一个分类器，能够将图像分类到对应的正确标签中。

### **问题 1：数据集**

1. 在你的 Anaconda 环境中安装 PyTorch。使用以下命令安装仅支持 CPU 的版本：
   ```bash
   conda install -c pytorch pytorch torchvision cpuonly
   ```
2. 使用 `torchvision.datasets` 模块加载数据集（包括训练集和测试集）。注意，您可能需要使用 `transform` 选项将图像转换为 Tensor 格式。默认情况下，图像以 PIL 图像格式提供。
3. 使用 `matplotlib` 绘制一些灰度图像，并确保在报告中包含至少一个来自每个数据集的图像。
4. 验证图像是否具有正确的维度（28×28）以及数值是否已归一化到 [0, 1] 范围内。

### **问题 2：单隐藏层网络**

1. 构建一个仅包含单隐藏层的全连接前馈神经网络。  
2. 使用 ReLU 作为激活函数。  
3. 使用随机梯度下降（`torch.optim.SGD`）进行优化，并采用交叉熵损失（`torch.nn.CrossEntropyLoss`）作为损失函数。  
4. 训练网络至少 10 个 epoch，并在每个 epoch 后报告网络在测试集上的验证准确率。
5. 报告您选择的所有相关参数。

### **问题 3：双隐藏层网络**

1. 构建一个包含两个隐藏层的全连接前馈神经网络，两个隐藏层分别具有 500 和 300 个单元。
2. 使用 ReLU、SGD 和交叉熵损失，与问题 2 类似。
3. 启用 L2 正则化，并为优化器的 `weight_decay` 参数选择一个适当的（通常较小的）值。
4. 训练网络至少 40 个 epoch，并在每个 epoch 后报告验证准确率。
5. 您的模型应达到至少 98% 的准确率。

### **问题 4：卷积神经网络**

1. 构建一个包含至少两个卷积层的前馈网络。
2. 同样使用 ReLU、SGD 和交叉熵损失，并为权重衰减选择适当的值。
3. 训练网络至少 40 个 epoch，并在每个 epoch 后报告验证准确率。
4. 您的模型应达到至少 99% 的准确率。如果无法达到该值，请报告实际达到的准确率。
5. 描述您的网络结构以及所有相关参数选择。

### 提示：
- MNIST 数据集可以通过 Canvas 获取，但格式较为繁琐，建议直接使用 PyTorch 功能下载数据集。
- 请参考 PyTorch 文档及教程：[PyTorch 教程](https://pytorch.org/tutorials/beginner/basics/intro.html)。
- 学习如何使用数据集和数据加载器（datasets 和 dataloaders）。
- 使用 `matplotlib` 的 `imshow` 函数绘制位图图像。
- 注意所有未在说明中提到但可能影响模型和训练的参数，例如学习率和隐藏单元数量。
- 确保了解评估过程中每一步的张量维度（`forward` 函数）。
- 仔细研究示例。

### 报告提交要求：
- 撰写一份 LATEX 排版的报告，回答所有上述问题。
- 在报告附录中包含所有 Python 代码，建议使用 `listings` 包。
- 报告内容应即使不查看代码也易于理解。
- 如果引用外部资源，请使用 \cite 添加适当的参考文献，包括网址引用。建议使用 `biblatex` 管理引用。
- 使用带有编号的图表环境（figure/table）来展示图像和表格，并为其添加描述性标题，并在讨论中引用这些图表。
- 若初次提交未被接受，将根据助教的评论进行修改重交。但第二次提交仍未通过，则需重新参加课程的后续迭代。


### 截止日期说明：
**截止时间严格执行，逾期提交将不被阅读，视为未通过。** 这意味着您将无法获得首次反馈，提交将视为修改稿；且无第三次机会。如果逾期提交失败，则需在后续课程中重新尝试。


### 参考文献：
[1] Yann LeCun, Corinna Cortes, and Christopher J.C. Burges. The MNIST database of handwritten digits. Retrieved 2024-01-02. 1998. url: [MNIST 数据集](http://yann.lecun.com/exdb/mnist/)
